---
title: "Human Development Index Data Cleaning"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

## Loading Libraries

```{r}
library(rio)
library(dplyr)
library(knitr)
```

## Import Data from GitHub

```{r}
link = "https://github.com/FundamentalsSid601/FinalHW-Ex2/raw/main/HDR25_Statistical_Annex_HDI_Table.xlsx"
```

## Explore Raw Data

```{r}
raw_data <- rio::import(link)
head(raw_data, 15)
```

## Read Data with Correct Skip

```{r}
hdi_raw <- rio::import(link, skip = 7)
head(hdi_raw, 10)
```

## Select and Rename Columns

```{r}
hdi_selected <- hdi_raw[, c(2, 5, 7, 9, 11)]
names(hdi_selected) <- c("Country",
                         "Life_expectancy_at_birth",
                         "Expected_years_of_schooling",
                         "Mean_years_of_schooling",
                         "GNI_per_capita")
head(hdi_selected, 10)
```

## Filter Countries and Remove Missing Values

```{r}
hdi_filtered <- hdi_selected %>%
  mutate(
    Life_expectancy_at_birth = as.numeric(Life_expectancy_at_birth),
    Expected_years_of_schooling = as.numeric(Expected_years_of_schooling),
    Mean_years_of_schooling = as.numeric(Mean_years_of_schooling),
    GNI_per_capita = as.numeric(gsub(",", "", GNI_per_capita))
  )

hdi_countries <- hdi_filtered %>%
  filter(!is.na(Country) & Country != "") %>%
  filter(!is.na(Life_expectancy_at_birth)) %>%
  filter(!is.na(Expected_years_of_schooling)) %>%
  filter(!is.na(Mean_years_of_schooling)) %>%
  filter(!is.na(GNI_per_capita)) %>%
  filter(!grepl("^[A-Z ]+$", Country)) %>%
  filter(!grepl("development|region|world|states|countries|average", Country, ignore.case = TRUE))

print(paste("Number of countries:", nrow(hdi_countries)))
```

## Final Cleaned Dataset

```{r}
kable(head(hdi_countries, 50), digits = 2)
```

## Compute Means

```{r}
means <- hdi_countries %>%
  summarise(
    `Life expectancy at birth` = mean(Life_expectancy_at_birth),
    `Expected years of schooling` = mean(Expected_years_of_schooling),
    `Mean years of schooling` = mean(Mean_years_of_schooling),
    `GNI per capita` = mean(GNI_per_capita)
  )

kable(t(means), col.names = "Mean Value", digits = 2)
```

## Save Cleaned Data

```{r}
write.csv(hdi_countries, "HDI_cleaned_data.csv", row.names = FALSE)
```
